[11.11.22|19:03:17] Parameters:
{'work_dir': './work_dir/train/disfa/exp5/1', 'config': './config/exp5/train1.yaml', 'phase': 'train', 'save_result': False, 'start_epoch': 0, 'num_epoch': 20, 'use_gpu': True, 'device': [0], 'log_interval': 1000, 'save_interval': 5, 'eval_interval': 1, 'save_log': True, 'print_log': True, 'pavi_log': False, 'feeder': 'feeder.feeder_image_causal.Feeder', 'num_worker': 0, 'train_feeder_args': {'label_path': '/home/hfut1609/Disk_sda/hzy/faceAU/CIS/data/DISFA/list_random2.1/train1_label.pkl', 'image_path': '/home/hfut1609/Disk_sda/hzy/faceAU/CIS/data/DISFA/list_random2.1/train1_imagepath.pkl', 'image_size': 256, 'istrain': True, 'debug': False}, 'test_feeder_args': {'label_path': '/home/hfut1609/Disk_sda/hzy/faceAU/CIS/data/DISFA/list_random2.1/test1_label.pkl', 'image_path': '/home/hfut1609/Disk_sda/hzy/faceAU/CIS/data/DISFA/list_random2.1/test1_imagepath.pkl', 'image_size': 256, 'istrain': False, 'debug': False}, 'batch_size': 4, 'test_batch_size': 4, 'debug': False, 'model': 'net.CISNet.Model', 'model_args': {'num_class': 8, 'backbone': 'resnet34', 'temporal_model': 'single', 'subject': True, 'pooling': True, 'd_in': 512, 'd_m': 256, 'd_out': 512}, 'weights': None, 'ignore_weights': [], 'seed': 42, 'base_lr': 0.001, 'step': [], 'optimizer': 'SGD', 'nesterov': True, 'weight_decay': 0.0005, 'lr_decay': 0.3, 'loss': 'clf', 'loss_weight': [0.05796583600359621, 0.0502662578667097, 0.14906982641370248, 0.0780216233661449, 0.04824915281587865, 0.12274372392171327, 0.2655778141497038, 0.08540999100947463], 'resume': '', 'backbone_only': True, 'pretrain': True, 'clf_only_epoch': 1}

[11.11.22|19:03:17] Training epoch: 0
[11.11.22|19:03:18] 	Iter 0 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:03:35] 	Iter 1000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:03:53] 	Iter 2000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:04:10] 	Iter 3000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:04:27] 	Iter 4000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:04:44] 	Iter 5000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:05:01] 	Iter 6000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:05:19] 	Iter 7000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:05:36] 	Iter 8000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:05:54] 	Iter 9000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:06:11] 	Iter 10000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:06:28] 	Iter 11000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:06:46] 	Iter 12000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:07:03] 	Iter 13000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:07:21] 	Iter 14000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:07:38] 	Iter 15000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:07:57] 	Iter 16000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:08:15] 	Iter 17000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:08:32] 	Iter 18000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:08:49] 	Iter 19000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:09:05] 	Iter 20000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:09:21] 	Iter 21000 Done. | loss: 0 | lr: 0.001000
[11.11.22|19:09:32] 	mean_loss: 0.0
[11.11.22|19:09:32] Time consumption:
===> loss: 0.0
===> f1: [0.13115814 0.09593949 0.27560131 0.08233636 0.09205785 0.00149588
 0.00752777 0.10354916]
===> acc: [0.38914888 0.05350639 0.28378441 0.8222025  0.04846927 0.87689612
 0.73253723 0.68327263]
===> TP: [4.000e+03 4.357e+03 1.182e+04 6.920e+02 4.185e+03 8.000e+00 8.800e+01
 1.587e+03]
===> TN: [2.9761e+04 2.8500e+02 1.2800e+04 7.0639e+04 2.0000e+01 7.6068e+04
 6.3464e+04 5.7691e+04]
===> FN: [1.0290e+03 4.0000e+00 1.1120e+03 6.0770e+03 1.0000e+00 1.0641e+04
 2.2953e+04 5.8230e+03]
===> FP: [5.1966e+04 8.2110e+04 6.1024e+04 9.3480e+03 8.2550e+04 3.9000e+01
 2.5100e+02 2.1655e+04]
===> rec: [7.95386757e-01 9.99082779e-01 9.14011754e-01 1.02230758e-01
 9.99761108e-01 7.51244248e-04 3.81927868e-03 2.14170040e-01]
===> prec: [0.07147197 0.05038917 0.16226457 0.0689243  0.04825042 0.17021276
 0.25958702 0.06828156]
===> average f1: 0.09870824503732617
===> average acc: 0.48622717737101756
[11.11.22|19:09:37] Done.
[11.11.22|19:09:37] Eval epoch: 0
[11.11.22|19:12:28] 	mean_loss: 0.6555877713563956
===> loss: 0.6555877713563956
===> f1: [0.03636701 0.03951125 0.28739922 0.03678043 0.05734522 0.
 0.06041596 0.11997546]
===> acc: [0.54180809 0.02103018 0.3211632  0.84985322 0.02963031 0.85393542
 0.69755068 0.63294652]
===> TP: [ 377.  878. 5969.  125. 1287.    0.  424. 1091.]
===> TN: [2.3248e+04 3.9000e+01 8.0350e+03 3.6932e+04 5.0000e+00 3.7235e+04
 2.9992e+04 2.6508e+04]
===> FN: [ 1092.     0.   684.  3433.     0.  6187. 12781.  3032.]
===> FP: [18887. 42687. 28916.  3114. 42312.   182.   407. 12973.]
===> rec: [0.25663717 1.         0.89718924 0.0351321  1.         0.
 0.03210905 0.26461315]
===> prec: [0.01957018 0.02015379 0.17110506 0.03859216 0.02951903 0.
 0.51022864 0.07757395]
===> average f1: 0.07972431864528337
===> average acc: 0.4934897027795615
[11.11.22|19:12:30] Done.
[11.11.22|19:12:30] Training epoch: 1
[11.11.22|19:12:47] 	Iter 22000 Done. | loss: 0.3008 | lr: 0.001000
[11.11.22|19:13:35] 	Iter 23000 Done. | loss: 0.3937 | lr: 0.001000
[11.11.22|19:14:26] 	Iter 24000 Done. | loss: 0.2652 | lr: 0.001000
[11.11.22|19:15:22] 	Iter 25000 Done. | loss: 0.0492 | lr: 0.001000
[11.11.22|19:16:14] 	Iter 26000 Done. | loss: 0.2258 | lr: 0.001000
[11.11.22|19:17:02] 	Iter 27000 Done. | loss: 0.0921 | lr: 0.001000
[11.11.22|19:17:54] 	Iter 28000 Done. | loss: 0.1074 | lr: 0.001000
[11.11.22|19:18:44] 	Iter 29000 Done. | loss: 0.1563 | lr: 0.001000
[11.11.22|19:19:32] 	Iter 30000 Done. | loss: 0.1084 | lr: 0.001000
[11.11.22|19:20:24] 	Iter 31000 Done. | loss: 0.1488 | lr: 0.001000
[11.11.22|19:21:13] 	Iter 32000 Done. | loss: 0.0275 | lr: 0.001000
[11.11.22|19:22:05] 	Iter 33000 Done. | loss: 0.0924 | lr: 0.001000
[11.11.22|19:22:55] 	Iter 34000 Done. | loss: 0.0154 | lr: 0.001000
[11.11.22|19:23:42] 	Iter 35000 Done. | loss: 0.0217 | lr: 0.001000
[11.11.22|19:24:29] 	Iter 36000 Done. | loss: 0.0136 | lr: 0.001000
[11.11.22|19:25:17] 	Iter 37000 Done. | loss: 0.1366 | lr: 0.001000
[11.11.22|19:26:05] 	Iter 38000 Done. | loss: 0.0105 | lr: 0.001000
[11.11.22|19:26:55] 	Iter 39000 Done. | loss: 0.1213 | lr: 0.001000
[11.11.22|19:27:47] 	Iter 40000 Done. | loss: 0.0200 | lr: 0.001000
[11.11.22|19:28:35] 	Iter 41000 Done. | loss: 0.2594 | lr: 0.001000
[11.11.22|19:29:24] 	Iter 42000 Done. | loss: 0.0984 | lr: 0.001000
[11.11.22|19:30:13] 	Iter 43000 Done. | loss: 0.0108 | lr: 0.001000
[11.11.22|19:30:31] 	mean_loss: 0.11119566267148934
[11.11.22|19:30:31] Time consumption:
===> loss: 0.11119566267148934
===> f1: [0.4777758  0.6006626  0.77918082 0.59248727 0.51056063 0.70672975
 0.90138207 0.51620219]
===> acc: [0.95734013 0.96945456 0.94136429 0.95022823 0.96581216 0.93902439
 0.95050486 0.94131818]
===> TP: [ 1693.  1993.  8975.  3139.  1547.  6374. 19624.  2716.]
===> TN: [81362. 82113. 72694. 79299. 82243. 75092. 62838. 78949.]
===> FN: [3336. 2368. 3957. 3630. 2639. 4275. 3416. 4694.]
===> FP: [ 365.  282. 1130.  688.  327. 1015.  878.  397.]
===> rec: [0.33664744 0.45700527 0.69401485 0.46373172 0.36956522 0.59855385
 0.85173611 0.36653171]
===> prec: [0.82264334 0.87604396 0.88817417 0.82022472 0.82550694 0.86263364
 0.95717491 0.87247029]
===> average f1: 0.6356226418201043
===> average acc: 0.9518808497394993
[11.11.22|19:30:36] Done.
[11.11.22|19:30:36] Eval epoch: 1
[11.11.22|19:33:18] 	mean_loss: 0.14429036285232466
===> loss: 0.14429036285232466
===> f1: [0.43635162 0.50339005 0.67444252 0.57410835 0.42017757 0.805064
 0.93967341 0.4676802 ]
===> acc: [0.95917806 0.97144757 0.87902486 0.906293   0.9551876  0.94385836
 0.96436107 0.92936428]
===> TP: [  689.   631.  5464.  2754.   708.  5055. 12103.  1353.]
===> TN: [41135. 41728. 32865. 36764. 40942. 36101. 29947. 39171.]
===> FN: [ 780.  247. 1189.  804.  579. 1132. 1102. 2770.]
===> FP: [1000.  998. 4086. 3282. 1375. 1316.  452.  310.]
===> rec: [0.46902655 0.71867882 0.82128363 0.77403035 0.55011655 0.81703572
 0.91654676 0.32815911]
===> prec: [0.40793369 0.3873542  0.5721466  0.45626243 0.33989438 0.79343902
 0.96399841 0.8135899 ]
===> average f1: 0.6026109661042207
===> average acc: 0.9385893496009541
[11.11.22|19:33:20] Done.
[11.11.22|19:33:20] Training epoch: 2
[11.11.22|19:33:50] 	Iter 44000 Done. | loss: 0.0008 | lr: 0.001000
[11.11.22|19:34:36] 	Iter 45000 Done. | loss: 0.3239 | lr: 0.001000
[11.11.22|19:35:22] 	Iter 46000 Done. | loss: 0.0572 | lr: 0.001000
[11.11.22|19:36:08] 	Iter 47000 Done. | loss: 0.1269 | lr: 0.001000
[11.11.22|19:37:01] 	Iter 48000 Done. | loss: 0.0940 | lr: 0.001000
[11.11.22|19:37:50] 	Iter 49000 Done. | loss: 0.0361 | lr: 0.001000
[11.11.22|19:38:38] 	Iter 50000 Done. | loss: 0.0590 | lr: 0.001000
[11.11.22|19:39:28] 	Iter 51000 Done. | loss: 0.0067 | lr: 0.001000
[11.11.22|19:40:20] 	Iter 52000 Done. | loss: 0.0126 | lr: 0.001000
[11.11.22|19:41:17] 	Iter 53000 Done. | loss: 0.0092 | lr: 0.001000
[11.11.22|19:42:07] 	Iter 54000 Done. | loss: 0.0260 | lr: 0.001000
[11.11.22|19:42:56] 	Iter 55000 Done. | loss: 0.0840 | lr: 0.001000
[11.11.22|19:43:44] 	Iter 56000 Done. | loss: 0.0037 | lr: 0.001000
[11.11.22|19:44:33] 	Iter 57000 Done. | loss: 0.0150 | lr: 0.001000
[11.11.22|19:45:22] 	Iter 58000 Done. | loss: 0.2024 | lr: 0.001000
[11.11.22|19:46:15] 	Iter 59000 Done. | loss: 0.0003 | lr: 0.001000
[11.11.22|19:47:07] 	Iter 60000 Done. | loss: 0.0544 | lr: 0.001000
[11.11.22|19:47:59] 	Iter 61000 Done. | loss: 0.0039 | lr: 0.001000
[11.11.22|19:48:49] 	Iter 62000 Done. | loss: 0.0284 | lr: 0.001000
[11.11.22|19:49:43] 	Iter 63000 Done. | loss: 0.0074 | lr: 0.001000
[11.11.22|19:50:32] 	Iter 64000 Done. | loss: 0.1010 | lr: 0.001000
[11.11.22|19:51:20] 	Iter 65000 Done. | loss: 0.1042 | lr: 0.001000
[11.11.22|19:51:23] 	mean_loss: 0.04813642216275211
[11.11.22|19:51:23] Time consumption:
===> loss: 0.04813642216275211
===> f1: [0.82564701 0.87542364 0.92549958 0.84956916 0.82132515 0.88089794
 0.97019847 0.85874519]
===> acc: [0.98091198 0.98815068 0.97819171 0.977235   0.98427774 0.97151782
 0.98432385 0.9773618 ]
===> TP: [ 3921.  3612. 11752.  5577.  3135.  9138. 22138.  5970.]
===> TN: [81179. 82116. 73112. 79204. 82257. 75147. 63258. 78822.]
===> FN: [1108.  749. 1180. 1192. 1050. 1511.  903. 1440.]
===> FP: [548. 279. 712. 783. 314. 960. 457. 524.]
===> rec: [0.77967787 0.8282504  0.90875348 0.82390309 0.74910394 0.85810874
 0.96080899 0.80566802]
===> prec: [0.87737749 0.92829607 0.94287548 0.87688679 0.90895912 0.90493167
 0.97977429 0.91931013]
===> average f1: 0.8759132663438389
===> average acc: 0.9802463230208862
[11.11.22|19:51:29] Done.
[11.11.22|19:51:29] Eval epoch: 2
[11.11.22|19:54:11] 	mean_loss: 0.12879771424741
===> loss: 0.12879771424741
===> f1: [0.33371519 0.52791833 0.72781015 0.56030598 0.52843839 0.84315453
 0.9283986  0.52353825]
===> acc: [0.92005321 0.97227319 0.91349417 0.91840198 0.97319053 0.95635721
 0.95780204 0.93083203]
===> TP: [  873.   676.  5043.  2267.   655.  5115. 11929.  1657.]
===> TN: [39245. 41719. 34789. 37779. 41780. 36586. 29835. 38931.]
===> FN: [ 596.  202. 1610. 1291.  632. 1072. 1276. 2466.]
===> FP: [2890. 1007. 2162. 2267.  537.  831.  564.  550.]
===> rec: [0.59428182 0.76993166 0.75800391 0.63715571 0.50893551 0.82673347
 0.90336994 0.40189183]
===> prec: [0.23199575 0.4016637  0.6999306  0.5        0.54949664 0.86024218
 0.95485472 0.75079293]
===> average f1: 0.6216599280708845
===> average acc: 0.9428005458214843
[11.11.22|19:54:13] Done.
[11.11.22|19:54:13] Training epoch: 3
[11.11.22|19:54:59] 	Iter 66000 Done. | loss: 0.0984 | lr: 0.001000
[11.11.22|19:55:48] 	Iter 67000 Done. | loss: 0.0160 | lr: 0.001000
[11.11.22|19:56:37] 	Iter 68000 Done. | loss: 0.0026 | lr: 0.001000
[11.11.22|19:57:26] 	Iter 69000 Done. | loss: 0.0015 | lr: 0.001000
[11.11.22|19:58:14] 	Iter 70000 Done. | loss: 0.0005 | lr: 0.001000
[11.11.22|19:59:02] 	Iter 71000 Done. | loss: 0.1005 | lr: 0.001000
[11.11.22|19:59:50] 	Iter 72000 Done. | loss: 0.0010 | lr: 0.001000
[11.11.22|20:00:40] 	Iter 73000 Done. | loss: 0.0024 | lr: 0.001000
[11.11.22|20:01:29] 	Iter 74000 Done. | loss: 0.0843 | lr: 0.001000
[11.11.22|20:02:17] 	Iter 75000 Done. | loss: 0.0021 | lr: 0.001000
[11.11.22|20:03:06] 	Iter 76000 Done. | loss: 0.0499 | lr: 0.001000
[11.11.22|20:03:55] 	Iter 77000 Done. | loss: 0.0118 | lr: 0.001000
[11.11.22|20:04:49] 	Iter 78000 Done. | loss: 0.0101 | lr: 0.001000
[11.11.22|20:05:37] 	Iter 79000 Done. | loss: 0.0096 | lr: 0.001000
[11.11.22|20:06:25] 	Iter 80000 Done. | loss: 0.0192 | lr: 0.001000
[11.11.22|20:07:16] 	Iter 81000 Done. | loss: 0.0264 | lr: 0.001000
[11.11.22|20:08:05] 	Iter 82000 Done. | loss: 0.0201 | lr: 0.001000
[11.11.22|20:08:53] 	Iter 83000 Done. | loss: 0.0329 | lr: 0.001000
[11.11.22|20:09:42] 	Iter 84000 Done. | loss: 0.0225 | lr: 0.001000
[11.11.22|20:10:31] 	Iter 85000 Done. | loss: 0.0720 | lr: 0.001000
[11.11.22|20:11:19] 	Iter 86000 Done. | loss: 0.0824 | lr: 0.001000
[11.11.22|20:11:56] 	mean_loss: 0.03672334988761726
[11.11.22|20:11:56] Time consumption:
===> loss: 0.03672334988761726
===> f1: [0.88191983 0.91081995 0.94312969 0.88920792 0.8994004  0.9032778
 0.97359051 0.89561008]
===> acc: [0.98667527 0.99135506 0.98326341 0.98312509 0.99070958 0.97670478
 0.98607589 0.98289455]
===> TP: [ 4317.  3830. 12040.  5875.  3603.  9437. 22267.  6366.]
===> TN: [81283. 82176. 73264. 79417. 82347. 75298. 63281. 78906.]
===> FN: [ 711.  531.  893.  894.  583. 1212.  774. 1044.]
===> FP: [445. 219. 559. 570. 223. 809. 434. 440.]
===> rec: [0.85859189 0.87823894 0.93095183 0.86792732 0.86072623 0.8861865
 0.96640771 0.85910931]
===> prec: [0.90655187 0.94591257 0.9556314  0.91155935 0.94171458 0.92104236
 0.9808819  0.93535116]
===> average f1: 0.9121195214491097
===> average acc: 0.9851004541472635
[11.11.22|20:12:01] Done.
[11.11.22|20:12:01] Eval epoch: 3
[11.11.22|20:14:44] 	mean_loss: 0.12898267027271032
===> loss: 0.12898267027271032
===> f1: [0.4191114  0.70689606 0.68129536 0.61741989 0.38556289 0.81711163
 0.93107963 0.62173983]
===> acc: [0.93280433 0.98674434 0.89441336 0.9396615  0.96798459 0.94617466
 0.95940739 0.93679479]
===> TP: [ 1057.   697.  4921.  2123.   438.  5243. 11956.  2265.]
===> TN: [39617. 42329. 34079. 38850. 41770. 36014. 29878. 38583.]
===> FN: [ 412.  181. 1732. 1435.  849.  944. 1249. 1858.]
===> FP: [2518.  397. 2872. 1196.  547. 1403.  521.  898.]
===> rec: [0.7195371  0.79384966 0.73966632 0.59668353 0.34032634 0.84742201
 0.90541462 0.54935726]
===> prec: [0.29566434 0.63711152 0.63146413 0.6396505  0.44467005 0.78889558
 0.95824317 0.71609232]
===> average f1: 0.6475270875513246
===> average acc: 0.9454981194385836
[11.11.22|20:14:46] Done.
[11.11.22|20:14:46] Training epoch: 4
[11.11.22|20:14:58] 	Iter 87000 Done. | loss: 0.0007 | lr: 0.001000
[11.11.22|20:15:46] 	Iter 88000 Done. | loss: 0.0061 | lr: 0.001000
[11.11.22|20:16:34] 	Iter 89000 Done. | loss: 0.0501 | lr: 0.001000
[11.11.22|20:17:23] 	Iter 90000 Done. | loss: 0.0414 | lr: 0.001000
[11.11.22|20:18:13] 	Iter 91000 Done. | loss: 0.0112 | lr: 0.001000
[11.11.22|20:19:04] 	Iter 92000 Done. | loss: 0.0035 | lr: 0.001000
[11.11.22|20:19:53] 	Iter 93000 Done. | loss: 0.1079 | lr: 0.001000
[11.11.22|20:20:44] 	Iter 94000 Done. | loss: 0.0412 | lr: 0.001000
[11.11.22|20:21:36] 	Iter 95000 Done. | loss: 0.0320 | lr: 0.001000
[11.11.22|20:22:27] 	Iter 96000 Done. | loss: 0.0085 | lr: 0.001000
[11.11.22|20:23:15] 	Iter 97000 Done. | loss: 0.0014 | lr: 0.001000
[11.11.22|20:24:03] 	Iter 98000 Done. | loss: 0.0018 | lr: 0.001000
[11.11.22|20:24:52] 	Iter 99000 Done. | loss: 0.0944 | lr: 0.001000
[11.11.22|20:25:40] 	Iter 100000 Done. | loss: 0.0139 | lr: 0.001000
[11.11.22|20:26:29] 	Iter 101000 Done. | loss: 0.0032 | lr: 0.001000
[11.11.22|20:27:17] 	Iter 102000 Done. | loss: 0.0533 | lr: 0.001000
[11.11.22|20:28:08] 	Iter 103000 Done. | loss: 0.0016 | lr: 0.001000
